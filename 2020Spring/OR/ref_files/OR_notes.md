# 运筹学基础

<p align=right>by 鸢一折纸</p>

## 二、线性规划及单纯形法

- 记得转化成<font size=5>标准型</font>
- 可行解与最优解：满足约束条件的解为可行解，使目标函数达到最大的可行解为最优解
- 基和基变量
- 决策变量 $x_{j}$，价值系数 $c_j$，技术系数 $a_{ij}$，限额系数 $b_i$

> 普通单纯形法

- 找出/构造可行基：松弛变量、人工变量
- 基变换：先确定换入变量、再确定换出变量 (先竖着看再横着看)
	- 换入变量指这次变换之后成为基变量的；vice versa
	- 检验数 $max(δ_j>0)$；θ规则：$min(b_i/a_{ik}\mid a_{ik}>0)$
- 解的情况 (调整顺序之后，前m个是基变量)
	- 最优解：$\sigma_j\le0$ ( j为非基变量下标)，其中 $\sigma_j=c_j-\sum_{i=1}^mc_ia_{ij}$，即第j列的价值系数减去技术系数加权(基变量的价值系数)和
	- <font color=coral>Important : </font>无穷多最优解：有非基变量检验数为0
	- 无界解：$\exists\ \sigma_{m+k}>0$，且该列所有技术系数均为负数
- 单纯形表（略）
- <font color=green>**人工变量法**</font>
	- 大M法：人工变量在目标函数中的价值系数为-M，人工变量必须换出
	- 两阶段法：
		1. 只考虑人工变量，构造含人工变量的目标函数和要求实现最小化 $min\ \omega=0X+X_S$
			- 取 $min(\delta_j<0),\ min(\theta_k>0)$
		2. 若得到最小值 $\omega_0=0$，则进行第二阶段
		3. 删去人工变量，并替换目标函数行的系数，再解一遍。。。
	- 无可行解：有人工变量没有换出
- **退化**：$\sigma$或$\theta$ 规则计算时，有两个以上的最小相同比值
	- Blend 法则
	- 选取 $c_j-z_j$ 中下标最小的 $\Rightarrow$ 换入变量
	- 选取 $\theta$ 比值中下标最小的 $\Rightarrow$ 换出变量
- 多余性：几何多余、数学多余、零变量

## 三、对偶理论与灵敏度分析

- **单纯形法的矩阵描述** <font color=deeppink>我不会…</font>
	- 表示符号：松弛变量 $X_S$，目标函数中基变量系数 $C_B$，非基变量 $C_N$，新换入的变元的系数矩阵 $P_k$
	- 迭代后的单纯形表，各部分的数字都是用 $B^{-1}$ 计算的，在初始单位矩阵的位置，经过迭代运算之后，就是 $B^{-1}$ 的位置

> 单纯形法的矩阵计算

1. 初始化：人工、松弛 (初始基矩阵) 的逆 $B^{-1}$，$B^{-1}b$
2. 最优测试： $\sigma_N=c_N-c_B\cdot B^{-1}N$
3. 新的逆矩阵：用 $\begin{pmatrix}-\frac{a_{1k}}{a_{lk}}\ \cdots\ \frac{1}{a_{lk}}\ \cdots\ -\frac{a_{mk}}{a_{lk}}\end{pmatrix}^T$ 取代对应单位矩阵的列，并右乘 $B^{-1}$，即得到新的 $B^{-1}$，$B_2^{-1}=E_1B_1^{-1}$
4. 确定换入变量：$max(\sigma_j>0)=\sigma_k$
5. 确定换出变量：$\theta=min\left\{\frac{(B^{-1}b)_i}{(B^{-1}P_k)_i}\mid(B^{-1}P_k)_i>0\right\}$
6. <font color=coral>b 和 N 均直接从约束条件而非上次计算得</font>

- 对偶问题
	
	- 对称形式：目标函数求极大值时，所有约束条件为≤号，变量非负；目标函数求极小值时，所有约束条件为≥号，变量非负

	- 对称性：

	- 弱对偶性：原问题的可行解 $\overline{X}$，对偶问题可行解 $\bar{Y}$，则 $C\overline{X}\leq\overline{Y}b$，取等时同时达到最优解

	- 对应关系如下：
	
	- | 原问题                                                 | 对偶问题                                               |
	  | ------------------------------------------------------ | ------------------------------------------------------ |
	  | 目标函数 max z                                         | 目标函数 min w                                         |
	  | 变量 $\begin{cases}n个\\\ge0\\\le0\\无约束\end{cases}$ | 约束条件 $\begin{cases}n个\\\ge\\\le\\=\end{cases}$    |
	  | 约束条件 $\begin{cases}n个\\\le\\\ge\\=\end{cases}$    | 变量 $\begin{cases}n个\\\ge0\\\le0\\无约束\end{cases}$ |
  | 约束条件右边的项 $\vec{b}$                             | 目标函数变量的系数 $\vec{c}$                           |
	  | 目标函数变量的系数 $\vec{c}$                           | 约束条件右边的项 $\vec{b}$                             |
	
	- 无界性：原/对偶问题有无界解 $\Rightarrow$ 对偶/原问题无可行解
	
	- 对偶定理：若原问题有最优解，那么对偶问题也有最优解，且目标函数值相等
	
	- $\hat{Y}X_S=0\ 且\ Y_S\hat{X}=0\Leftrightarrow\hat{X}、\hat{Y}$ 为优解，其中 $\hat{X}、\hat{Y}$ 分别为原问题、对偶问题的可行解
	
	- 原问题单纯形表的检验数行对应其对偶问题的一个基解，详细的见下面👇
	
- 影子价格 <font color=deeppink>这里我也不会…</font>

	- 影子价格是根据资源在生产中作出的贡献而做的估价。它是一种边际价格，其值相当于在资源得到最优利用的生产条件下，资源每增加一个单位时目标函数的增加量
	- 影子价格反应资源转化成经济效益的效率，也反映了稀缺程度
	- 转**灵敏度分析**

> 对偶单纯形法

- 关于对偶单纯形法
- 
	- 在单纯形表中进行迭代时，在b列中得到的是原问题的基可行解，而检验数行是对偶问题的<font color=coral>基解</font> (不一定是可行解)
	- 通过逐步迭代，当在检验数行得到的对偶问题的解也是可行解的时候，<font color=coral>就是最优解</font>，即原问题和对偶问题都是最优解
	- 优点是原问题的初始解不一定是基可行解，可以从非基可行解开始迭代
- 计算步骤：
	- 从具有对偶可行性的对偶基可行解出发，当右端 $b^*=B^{-1}b\ge0$ 时，原问题也获得了基可行解，因而得到最优解，具体如下：
	- 对线性规划问题进行变换，使列出的初始单纯形表中所有检验数 $\sigma_j\leq0$，即对偶问题为可行解
	- 检查 b 列，若都非负，又检验数为非正，则得到**最优解**；反之 continue
	- 确定换出变量：按照 $min\{(B^{-1}b)_i\mid(B^{-1}b)_i<0\}=(B^{-1}b)_l$ 来确定 $x_l$ 为换出变量
	- 确定换入变量：检查 $x_l$ 所在行的系数，若都大于0，则**无可行解**；反之按照$\theta$规则 $\theta=min(\frac{c_j-z_j}{a_{lj}}\mid a_{lj}<0)=\frac{\sigma_k}{a_{lk}}$ 来确定换入变量
	- 单纯形迭代
- <font color=coral>注意</font>：
	- 对偶单纯形法是先确定换出变量，后确定换入变量，与普通的相反
	- 对偶单纯形法虽然简化计算，但是大多数情况下很难找到一个初始可行基
	- 对偶单纯形法不是用来求对偶问题的

> 灵敏度分析

- 灵敏度分析
	
	- 是研究分析参数 $c_j,b_i,a_{ij}$ 的波动对最优解的影响**程度**
	
	- | 原问题   | 对偶问题 | 结论或继续计算的步骤                   |
		| -------- | -------- | -------------------------------------- |
		| 可行解   | 可行解   | 表中的解仍未可行解                     |
		| 可行解   | 非可行解 | 用单纯形法迭代求最优解                 |
		| 非可行解 | 可行解   | 用对偶单纯形法迭代求最优解             |
		| 非可行解 | 非可行解 | 引入人工变量，编制新的单纯形表求最优解 |

## 四、运输问题

- 性质
	- 可行解特性、成本 (线性) 假设、整数解性质 (只要供应量和需求量都是整数，任何有可行解的运输问题必然有决策变量都是整数的最优解)

> 表上作业法

- 本质
	- 本质是单纯形法
	- 表中每一个格子是一个决策变量，同样会有换入变量、换出变量，只是形式上不太一样
- 步骤
	- 找出初始基可行解，m✖️n的表给出m+n+1个值，称为数字格
	- 求非基变量的检验数，判断是不是最优解
	- 不是就调整
- 找出初始基可行解
	- 西北角法
	- 最小元素法：就近供应，从最小的元素开始，然后次小…
	- 伏格尔法：
		- 计算行差和列差 (最小运费和次小运费的差额)
		- 选择基变量：行、列差里面最大的，所在那一行/列的最小元素 $x_{ij}$ 
		- 确定基变量的值：$x_{ij}=min(a_i,b_j)$
		- 更新产销平衡表，划去为0的
- 最优解的判别
	- 所有非基变量检验数非负时为最优解
- 求检验数
	- 闭回路法
		- 遇到数字格转弯
		- 闭回路对应于线性组合
	- 位势法
		- 设 $u_1=0$，推导出剩下基变量的 $u_i、v_j$，$c_{ij}=u_i+v_j$
		- 检验数 $\sigma_{ij}=c_{ij}-u_i-v_j$
- 调整
	- 闭回路调整法
		- 若有两个或以上的负检验数时，选最小的为换入变量
		- 闭回路上 (-1) 的 $x_{ij}$ 最小的为换出变量
		- 加加减减
- 特殊情况
	- 无穷多最优解：某个非基变量检验数为0
	- 退化：确定初始可行基的时候不够，需要补0，在 (确定过程中) 同时被划去的行和列上；闭回路调整出现同样问题，还是补0 (表明还是基变量)
- 产销不平衡
	- 添加假想产销地，所有运费为0
- 各地带有弹性且供不应求 (最低XX，最高YY)
	- 根据实际需求量将销地拆开为必须满足和可选满足，并增加假想产地，到可选供应地运价为0，到刚需地运价为M，实际产地运价到两销地相同

## 五、线性目标规划

- 目标规划与线性规划
	- 目标规划对于每个限制方程添加了正负偏差变量 $d_i^+、d_i^-$ ($-d^++d^-$)
	- 正偏差分量表示决策值超过目标值的部分，vice versa
	- 绝对约束与目标约束 (必须满足和可允许误差)
	- 优先因子 (权系数)
	- 目标规划的目标函数
		- 恰好达到 $min\ z=f(d^++d^-)$
		- 要求不超过 $min\ z=f(d^+)$
		- 要求超过 $min\ z=f(d^-)$
- 求解
	- 图解法
	- 单纯形法
		- 检验数行变为检验数表，每个优先级的单独一行，当且仅当高优先级的检验数行对应列的检验数为0时开始考虑下面的检验数
		- 对于每一行，检查改行中是否存在负数，**且比他高优先级的对应列都是0**，有就取最小的 (+blend规则) 为换入变量
		- 由 $\theta$ 规则确定换出变量，**有一样的选有最高优先级的**
		- 有非基变量的检验数为0时，有多重解

## 六、整数线性规划

- LP松弛问题：不考虑整数/0-1限制条件的原整数线性规划问题
- 枚举……
- 分支定界解法 (分治思想)
	- 求LP-松弛问题的最优解 $\overline{z_0}$
	- 观察法得到整数线性规划的一个整数可行解 $\underline{z_0}$
	- 分支：$\overline{z_0}$ 的解里面找一个非零的分支变量 $x_j=b_j$，分支 $x_j\leq[b_j]$ 和 $x_j\ge\lbrack b_j+1\rbrack$
	- 定界：所有分支解里面的最大值为新上界，整数解里面最大值为新下界，kill掉上界比新下界小的分支
- Gomory割平面法
	- 求LP松弛问题的最优解
	- 割平面法指出怎样找适当的割平面，$s.t.$ 切割后的可行域，有一个整数坐标的极点就是问题的最优解
	- 在最后一张单纯形表 (最优解) 里面，取一个为分数值的**基变量** $x_i$，有 $x_i+\sum_ka_{ik}x_k=b_i$，其中 $i\in Q$ (基变量下标集合)，$k\in K$ (非基变量下标集合)
	- 将 $b_i$ 和 $a_{ik}$ 都分解为整数部分和小数部分 $b_i=N_i+f_i$，$a_{ik}=N_{ik}+f_{ik}$，其中 $0< f<1$，如 $-0.45=-1+0.55$
	- 将 $f_i-\sum f_{ik}x_{k}\le0$ 增加为约束条件，并增加松弛变量
	- 利用对偶单纯形法解 (此时为非可行解)
	- 一些说明
		- 略、略
		- 重要假设：所有变量 (包括松弛变量和剩余变量) 都是非负整数
			- 在引入松弛变量和剩余变量之前，在方程两边乘以适当的常数，使得所有系数都是整数
- **0-1整数线性规划**
	- 引入问题
	- 隐枚举法：
		- 增加过滤条件：试出来一个可行解组 X，然后添加目标方程≥现在的z值，并将其置为首要条件 (P0)
		- 应该注意的是，一般重拍目标函数中 $x_i$ 的顺序，使得系数是递增的

> 指派问题

- 匈牙利算法 (莫名图论)
	- 变换系数矩阵，使得各行各列中都有0元素
	- 试指派
		- 从只有一个0元素的行/列开始，给这个元素画圈圈 $\circledcirc$，同时将该列其他0划掉记为 ø
		- 给只有一个0元素的列/行的0画圈圈，其他0划掉
		- 重复以上两步，选0元素最少的行/列开始标
		- 若 $\circledcirc$ 的个数等于矩阵阶数，则得到最优解，否则：
	- 作最少直线覆盖
		- 没有 $\circledcirc$ 的行打 $\surd$
		- 打 $\surd$ 的行中 $\varnothing$ 所在列打 $\surd$
		- 对打 $\surd$ 的列中 $\circledcirc$ 所在的行打 $\surd$
		- 重复2、3，最终没有打对勾的划线
	- 第四步
		- 在没有被直线覆盖的部分找到最小的元素
		- 然后打 $\surd$ 的各行减去这个数，各列加上这个数
		- 重复第二步
- 指派问题的变异
	- 对于极大化，令 $b_{ij}=M-c_{ij}$，得到新的系数矩阵
	- 不可接受任务，对应交叉节点效率为M
	- 供需不平衡：虚拟单位，对应行/列效率为0

## 十三、排队论

- Kendall记号：X/Y/Z/A/B/C
	- 相继顾客到达间隔时间分布 / 服务时间分布 T / 服务台个数 / 系统容量限制 N / 顾客源数目 m / 服务规则
	- 分布：(负)指数分布 M / 确定型 D / k阶埃尔朗分布 Ek / 一般相互独立的时间间隔分布 GI / 一般服务时间的分布 G
- 指标：
	- 平均到达率：单位时间产生事件的速率 $\lambda$
	- 平均服务率：单位时间能被服务完成的顾客数 $\mu=1/ET$
	- 工作强度：$\rho=\frac{\lambda}{\mu}$
	- 有效到达率：在考虑容量或者顾客源有限的情况下的实际到达率 $\lambda_{e\!f\!f}$，在 $A=B=∞$ 的情况下 $\lambda=\lambda_{e\!f\!f}$
	- 队长：在系统中的顾客数，期望为 $L_S$
	- 队列长：排队等待的顾客数，期望为 $L_q$
	- 逗留时间：顾客在系统中的停留时间，期望为 $W_S$
	- 等待时间：顾客在系统中的排队时间，期望为 $W_q$
	- 忙期：顾客到达服务机构到服务机构再次空闲的时长
	- 系统的状态：系统中顾客数 n
	- 在时刻 t，系统状态为 n 的概率：$P_n(t)$
	- 损失率 $P_N$：被拒绝排队的顾客平均数 $\lambda P_N$
- 分布：
	- 泊松流：不需要用概统假设检验的方式去检验···
	- 埃尔朗分布
- Little 公式 (适用于顾客源稳定)
	- $L_S=\lambda_{e\!f\!f}W_S$
	- $L_q=\lambda_{e\!f\!f}W_q$
	- $W_S=W_q+1/\mu$
	- $L_S=L_q+\frac{\lambda_{eff}}{\mu}$

> 3✖️2➕1 种模型

1. 单队、单服务台
	1. 标准的 M/M/1 模型
	2. 容量有限制 M/M/1/N/∞：$\lambda_{e\!f\!f}=\lambda(1-P_N)$
	3. 顾客源有限 M/M/1/∞/m：$\lambda_{e\!f\!f}=\lambda(m-L_S)$
2. 单队、并列多服务台 $\rho=\lambda/c\mu$
	1. 标准的 M/M/c：$L_q=\frac{(c\rho)^c\rho}{c!(1-\rho)^2}P_0$
	2. 容量有限制 M/M/c/N/∞：$\lambda_{e\!f\!f}=\lambda(1-P_N)$
		- c=N (即时制)：$L_q=0$
	3. 顾客源有限 M/M/c/∞/m：$\lambda_{e\!f\!f}=\lambda(m-L_S),\ L_S=\sum_{n=1}^mnP_n$
3. 一般服务时间
	- 服务时间任意分布 M/G/1
		- P-K 公式：$\rho=\lambda\cdot ET<1,\ L_S=\rho+\frac{\rho^2+\lambda^2VarT}{2(1-\rho)}$
	- 定长服务时间 M/D/1
	- 埃尔朗服务时间 M/Ek/1

- 解题套路：求出来一个，然后Little公式

## 十四、存储论

我觉得画出货物存储量曲线是有帮助的···

> 5种模型

1. 确定性存储模型
	1. 不允许缺货，生产时间很短
	2. 不允许缺货，生产需一定时间
	3. 允许缺货，生产时间很短
	4. 允许缺货，生产需一定时间
	5. 价格有折扣/或者阶梯增长的存储问题
2. 随机性存储模型
	- 不考，我没看

- 参数
	- 订购费用 $C_3$，每一次都有，固定值
	- 补充存储：生产批量 $Q$，生产时间 $T$，生产速度 $P$
	- 消耗存储：需求速度 $R$，缺货损失 $C_2$，最大缺货量 $B$
	- 存储：存储的最高数量 $S$，单位存储费 $C_1$
- 解题过程
	- 根据供求关系、模型、所需参数，列出单位时间总费用 (平均费用) 满足的方程 $C(t)$
	- $C(t)$ 的含义是一个订货-消耗周期内，所需各种费用的平均值
	- 求导得到极值点 $t=t_0$ (分段函数另外讨论)，也就是最佳周期
	- 由 **E.O.Q** 公式得到 $Q_0=R\times t_0$

